import streamlit as st
import json
from datetime import datetime

# â”€â”€â”€ í˜ì´ì§€ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.set_page_config(
    page_title="ìœ íŠœë¸Œ ì˜ìƒì œì‘ ìë™í™”_hasira0410",
    page_icon="ğŸ¬",
    layout="wide"
)

# â”€â”€â”€ CSS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.markdown("""
<style>
    .main { background: #0f0f0f; color: #e0e0e0; }
    .stTextArea textarea { background: #1e1e1e; color: #e0e0e0; border: 1px solid #333; }
    .stTextInput input { background: #1e1e1e; color: #e0e0e0; border: 1px solid #333; }
    .stSelectbox select { background: #1e1e1e; color: #e0e0e0; }
    h1 { color: #ff4b4b; }
    h2 { color: #ff8c00; }
    h3 { color: #ffd700; }
    .output-box {
        background: #1a1a2e;
        border: 1px solid #ff4b4b;
        border-radius: 8px;
        padding: 16px;
        margin: 8px 0;
        font-family: monospace;
        white-space: pre-wrap;
        color: #e0e0e0;
    }
    .section-card {
        background: #1e1e1e;
        border-left: 4px solid #ff8c00;
        padding: 12px 16px;
        margin: 8px 0;
        border-radius: 4px;
    }
</style>
""", unsafe_allow_html=True)

# â”€â”€â”€ ìºë¦­í„° ë°ì´í„° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CHARACTERS = {
    "ğŸ‘¨ ë‚¨ì„±1) íƒë°° ê¸°ì‚¬(58)": {
        "ì§ì—…": "íƒë°° ê¸°ì‚¬ (58ì„¸)",
        "ê°€ì¡±": "ì•„ë‚´ + ì„±ì¸ìë…€ 1",
        "ìš•ë§": "ë³‘ì›ë¹„ë¥¼ ê°ë‹¹í•˜ë©° ì²´ë©´ ì§€í‚¤ê¸°",
        "ì••ë°•": "ì¹´ë“œê°’/ëŒ€ì¶œ ìƒí™˜",
        "íŠ¸ë¦¬ê±°": "ê²°ì œê°€ ê±°ì ˆëë‹¤",
        "ë°˜ì „": "ì•„ë‚´ê°€ ëª°ë˜ ë³´í—˜ì„ í•´ì§€í–ˆë‹¤"
    },
    "ğŸ‘¨ ë‚¨ì„±2) ì†Œê·œëª¨ ìì˜ì—…(55)": {
        "ì§ì—…": "ë¶„ì‹/ì¹´í˜ ìì˜ì—… (55ì„¸)",
        "ê°€ì¡±": "ì•„ë‚´ + ê³ ë“±í•™ìƒ ìë…€",
        "ìš•ë§": "ê°€ê²Œë¥¼ ì§€í‚¤ê³  ì•„ì´ í•™ì›ì„ ëŠì§€ ì•Šê¸°",
        "ì••ë°•": "ì„ëŒ€ë£Œ/ì›ì¬ë£Œ ì¸ìƒ",
        "íŠ¸ë¦¬ê±°": "ë‹¨ê³¨ì´ ê°‘ìê¸° ëŠê²¼ë‹¤",
        "ë°˜ì „": "ê°œì¸ ì‚¬ì •ì´ ì•„ë‹ˆë¼ ìƒê¶Œ êµ¬ì¡°ê°€ ë³€í–ˆë‹¤"
    },
    "ğŸ‘¨ ë‚¨ì„±3) í‡´ì§ í›„ ì¬ì·¨ì—…(62)": {
        "ì§ì—…": "ê²½ë¹„/ì‹œì„¤ ì¬ì·¨ì—… (62ì„¸)",
        "ê°€ì¡±": "í˜¼ì(ë˜ëŠ” ë°°ìš°ìì™€ ë³„ê±°)",
        "ìš•ë§": "ì“¸ëª¨ ìˆëŠ” ì‚¬ëŒìœ¼ë¡œ ë‚¨ê¸°",
        "ì••ë°•": "ê±´ê°•/ìˆ˜ì… ë¶ˆì•ˆ",
        "íŠ¸ë¦¬ê±°": "ê·¼ë¬´ ì¤‘ ì‹¤ì‹ í•  ë»”í–ˆë‹¤",
        "ë°˜ì „": "ë³‘ì´ ì•„ë‹ˆë¼ ì•½ì„ ì˜ëª» ë³µìš©í•˜ê³  ìˆì—ˆë‹¤"
    },
    "ğŸ‘¨ ë‚¨ì„±4) ê³µì¥ êµëŒ€ê·¼ë¬´(50)": {
        "ì§ì—…": "ê³µì¥ êµëŒ€ê·¼ë¬´ (50ì„¸)",
        "ê°€ì¡±": "ë°°ìš°ì + ì¤‘í•™ìƒ ìë…€ 2",
        "ìš•ë§": "ê°€ì¡±ì˜ ì•ˆì „í•œ ì¼ìƒ ìœ ì§€",
        "ì••ë°•": "ì•¼ê·¼/ì‚°ì¬ ë¶ˆì•ˆ",
        "íŠ¸ë¦¬ê±°": "ì‘ì€ ì‚¬ê³ ê°€ í° ë¬¸ì œë¡œ ë²ˆì¡Œë‹¤",
        "ë°˜ì „": "ì‚¬ê³ ê°€ ê°œì¸ ì‹¤ìˆ˜ë¡œ ë®ì´ë ¤ í•œë‹¤"
    },
    "ğŸ‘¨ ë‚¨ì„±5) ì§€ë°©â†’ìˆ˜ë„ê¶Œ ì´ì£¼(57)": {
        "ì§ì—…": "ì¼ìš©ì§ (57ì„¸, ì§€ë°©â†’ìˆ˜ë„ê¶Œ)",
        "ê°€ì¡±": "ì•„ë‚´(ì§€ë°©) + ì•„ë“¤(ì„œìš¸ ì·¨ì¤€)",
        "ìš•ë§": "ì•„ë“¤ì˜ ì²« ì§ì¥ë§Œí¼ì€ ë¶™ì¡ê¸°",
        "ì••ë°•": "ì›”ì„¸/ìƒí™œë¹„",
        "íŠ¸ë¦¬ê±°": "ì•„ë“¤ì´ ë©´ì ‘ì„ í¬ê¸°í–ˆë‹¤",
        "ë°˜ì „": "ì‹¤ë ¥ì´ ì•„ë‹ˆë¼ êµí†µë¹„/ì •ì¥ë¹„ê°€ ì´ìœ ì˜€ë‹¤"
    },
    "ğŸ‘© ì—¬ì„±1) ê°„ë³‘/ëŒë´„(56)": {
        "ì§ì—…": "ê°„ë³‘/ëŒë´„ (56ì„¸)",
        "ê°€ì¡±": "ë‚¨í¸ + ì–´ë¨¸ë‹ˆ(ì‹œ/ì¹œì •)",
        "ìš•ë§": "ê°€ì¡±ì„ ëŒë³´ë©´ì„œë„ ë‚´ê°€ ë¬´ë„ˆì§€ì§€ ì•Šê¸°",
        "ì••ë°•": "ì‹œê°„/ê±´ê°•/ê³ ë¦½",
        "íŠ¸ë¦¬ê±°": "ë³‘ì›ì—ì„œ ì „í™”ê°€ ì™”ë‹¤",
        "ë°˜ì „": "í™˜ì ë¬¸ì œê°€ ì•„ë‹ˆë¼ ë³¸ì¸ ê±´ê°• ê²½ê³ ì˜€ë‹¤"
    },
    "ğŸ‘© ì—¬ì„±2) ë§ˆíŠ¸/í¸ì˜ì  íŒŒíŠ¸(59)": {
        "ì§ì—…": "ë§ˆíŠ¸/í¸ì˜ì  íŒŒíŠ¸ (59ì„¸)",
        "ê°€ì¡±": "í˜¼ì(ë˜ëŠ” ë”¸ê³¼ ë™ê±°)",
        "ìš•ë§": "ìƒí™œë¹„ë¥¼ ìŠ¤ìŠ¤ë¡œ í•´ê²°í•˜ê¸°",
        "ì••ë°•": "ë¬¼ê°€/ì„ê¸ˆ ì •ì²´",
        "íŠ¸ë¦¬ê±°": "ê³„ì‚°ëŒ€ì—ì„œ í•œ ê³ ê°ì´ í­ë°œí–ˆë‹¤",
        "ë°˜ì „": "ë¶„ë…¸ì˜ ëŒ€ìƒì€ ë‚´ê°€ ì•„ë‹ˆë¼ ê°€ê²©í‘œ ë³€í™”ì˜€ë‹¤"
    },
    "ğŸ‘© ì—¬ì„±3) ì¤‘ë…„ ì¬ì·¨ì—… ì¤€ë¹„(52)": {
        "ì§ì—…": "ì¬ì·¨ì—… ì¤€ë¹„ (52ì„¸, ìê²©ì¦)",
        "ê°€ì¡±": "ë‚¨í¸ + ëŒ€í•™ìƒ ìë…€",
        "ìš•ë§": "ë‚˜ëŠ” ì•„ì§ ê°€ëŠ¥í•˜ë‹¤ ì¦ëª…í•˜ê¸°",
        "ì••ë°•": "ë‚˜ì´/ê²½ìŸ/ìì¡´ê°",
        "íŠ¸ë¦¬ê±°": "ë©´ì ‘ì—ì„œ í•œ ë§ˆë””ë¥¼ ë“¤ì—ˆë‹¤",
        "ë°˜ì „": "ë¶ˆí•©ê²©ì´ ì•„ë‹ˆë¼ ì±„ìš© ìì²´ê°€ ì·¨ì†Œì˜€ë‹¤"
    },
    "ğŸ‘© ì—¬ì„±4) ì£¼ë¶€(60, ìë…€ ë…ë¦½)": {
        "ì§ì—…": "ì „ì—…ì£¼ë¶€ (60ì„¸, ìë…€ ë…ë¦½)",
        "ê°€ì¡±": "ë‚¨í¸ + ìë…€(ë…ë¦½)",
        "ìš•ë§": "ë…¸í›„ ë¶ˆì•ˆì„ ì¤„ì´ê¸°",
        "ì••ë°•": "ì—°ê¸ˆ/ì €ì¶•/ë¬¼ê°€",
        "íŠ¸ë¦¬ê±°": "í†µì¥ ì”ê³ ë¥¼ ë‹¤ì‹œ í™•ì¸í–ˆë‹¤",
        "ë°˜ì „": "ë‚¨í¸ ì§€ì¶œì´ ì•„ë‹ˆë¼ ê³ ì •ë¹„ êµ¬ì¡°ê°€ ë¬¸ì œì˜€ë‹¤"
    },
    "ğŸ‘© ì—¬ì„±5) ë™ë„¤ ì†Œëª¨ì„ ë¦¬ë”(55)": {
        "ì§ì—…": "ì»¤ë®¤ë‹ˆí‹° ì†Œëª¨ì„ ë¦¬ë” (55ì„¸)",
        "ê°€ì¡±": "ë‚¨í¸ + ì„±ì¸ìë…€",
        "ìš•ë§": "ë™ë„¤ì— ì•ˆì „ë§ ë§Œë“¤ê¸°",
        "ì••ë°•": "ì‚¬ê¸°/ë²”ì£„/ë¶ˆì•ˆ ì´ìŠˆ",
        "íŠ¸ë¦¬ê±°": "ì•„ëŠ” ì‚¬ëŒì´ ë‹¹í–ˆë‹¤",
        "ë°˜ì „": "ë²”ì¸ì´ ì•„ë‹ˆë¼ ì •ë³´ ê³µë°±ì´ í•µì‹¬ì´ì—ˆë‹¤"
    }
}

# â”€â”€â”€ ì¼ë³¸ì–´ í›… ìƒì„± í•¨ìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def generate_hooks(trigger, theme, char_job):
    hooks = [
        f"ã€Œ{trigger}ã€â€•â€•ãã®ç¬é–“ã€{char_job}ã®äººç”ŸãŒå¤‰ã‚ã‚Šã¾ã—ãŸã€‚",
        f"ã¾ã•ã‹ã“ã‚“ãªå½¢ã§{theme}ã«ç›´é¢ã™ã‚‹ã¨ã¯ã€èª°ã‚‚æ€ã£ã¦ã„ãªã‹ã£ãŸã€‚",
        f"58æ­³ã€{theme}ã€‚ã‚ãªãŸã¯ä»Šã€æº–å‚™ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ",
        f"ã€Œå¤§ä¸ˆå¤«ã€ã¨è¨€ã„ç¶šã‘ãŸçµæœã€{trigger}ã¨ã„ã†ç¾å®ŸãŒå¾…ã£ã¦ã„ã¾ã—ãŸã€‚",
        f"{theme}ã¯ã€é ã„è©±ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚éš£ã®èª°ã‹ã®ã€ä»Šæ—¥ã®è©±ã§ã™ã€‚"
    ]
    return hooks

# â”€â”€â”€ í”Œë¡¯ ìƒì„± í•¨ìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def generate_plot(char, theme, detail_a, detail_b, detail_c, question):
    char_info = CHARACTERS[char]
    plot = f"""
ğŸ¬ ACT 1 (0:00~0:45) â€” í›…
{char_info['íŠ¸ë¦¬ê±°']} ê·¸ í•œ ë§ˆë””ì— {char_info['ì§ì—…']}ì˜ í•˜ë£¨ê°€ ë©ˆì·„ë‹¤.
[ì˜¤í”„ë‹: ì¼ìƒ ì¥ë©´ â†’ íŠ¸ë¦¬ê±° ì‚¬ê±´ ì»·]

ğŸ“‰ ACT 2 (0:45~6:30) â€” ì•…í™”
â–¸ í˜„ì‹¤ ë””í…Œì¼ A: {detail_a if detail_a else '(ì…ë ¥ í•„ìš”)'}
  â†’ ìºë¦­í„°ê°€ ì´ ìƒí™©ê³¼ ì¶©ëŒí•˜ëŠ” ì¥ë©´ ì‚½ì…

â–¸ í˜„ì‹¤ ë””í…Œì¼ B: {detail_b if detail_b else '(ì…ë ¥ í•„ìš”)'}
  â†’ ê°€ì¡±({char_info['ê°€ì¡±']})ê³¼ì˜ ê°ˆë“± ë˜ëŠ” ì¹¨ë¬µ ì¥ë©´

â–¸ í˜„ì‹¤ ë””í…Œì¼ C: {detail_c if detail_c else '(ì…ë ¥ í•„ìš”)'}
  â†’ ì••ë°•({char_info['ì••ë°•']})ì´ ì„ê³„ì ì— ë„ë‹¬í•˜ëŠ” ì¥ë©´

ğŸ”„ ë°˜ì „: {char_info['ë°˜ì „']}

âœ¨ ACT 3 (6:30~8:00) â€” ê²°ë§
ì„ íƒ: {char_info['ìš•ë§']}ì„ í¬ê¸°í•  ê²ƒì¸ê°€, ë‹¤ë¥¸ ê¸¸ì„ ì°¾ì„ ê²ƒì¸ê°€.
í¬ë§ 1ì¤„: ì‘ì€ í–‰ë™ í•˜ë‚˜ê°€ êµ¬ì¡°ë¥¼ ë°”ê¾¸ëŠ” ì‹œì‘ì´ ë  ìˆ˜ ìˆë‹¤.
ì¼ë³¸ ì‹œì²­ì ì§ˆë¬¸: {question if question else 'ë‹¹ì‹ ì´ë¼ë©´ ì–´ë–»ê²Œ í–ˆì„ê¹Œìš”ï¼Ÿ'}
"""
    return plot

# â”€â”€â”€ ë©”ì¸ ì•± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.title("ğŸ¬ ìœ íŠœë¸Œ ì˜ìƒì œì‘ ìë™í™”-hasira0410")
st.caption("ì¼ë³¸ 4060 ëŒ€ìƒ | ë¡±í¼ (ì—í”¼ì†Œë“œ 3 Ã— 5ë¶„ = 15~20ë¶„)")

tab1, tab2, tab3 = st.tabs(["ğŸ“‹ íŠ¸ë Œë“œ ì…ë ¥", "ğŸ“ í”Œë¡¯ ìƒì„±", "ğŸ“¤ ì‚°ì¶œë¬¼ ë‚´ë³´ë‚´ê¸°"])

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
with tab1:
    st.header("1) í•œêµ­ í˜„ì‹¤ ê·¼ê±°")
    
    col1, col2 = st.columns([1, 1])
    with col1:
        summary = st.text_input(
            "í•œ ì¤„ ìš”ì•½ (ë¬´ìŠ¨ ì¼ì´ ë²Œì–´ì§)",
            placeholder="ì˜ˆ: 50ëŒ€ ìì˜ì—…ì íì—…ë¥  ì—­ëŒ€ ìµœê³ ì¹˜ ê¸°ë¡"
        )
        theme_area = st.selectbox(
            "ì£¼ìš” í…Œë§ˆ ì˜ì—­",
            ["ëˆ (ê°€ê³„/ë¶€ì±„/íì—…)", "ê±´ê°• (ì˜ë£Œë¹„/ì•½ê°’/ëŒë´„)", "ê°€ì¡± (ê°ˆë“±/ë…ë¦½/ì´ë³„)", "ì¹˜ì•ˆ (ì‚¬ê¸°/ë²”ì£„/ë¶ˆì•ˆ)"]
        )
        jp_link = st.text_input(
            "ì¼ë³¸ ì—°ê²°ê³ ë¦¬",
            placeholder="ì˜ˆ: ì¼ë³¸ë„ 60ëŒ€ ìì˜ì—… íì—… ê¸‰ì¦ ì¤‘"
        )
    with col2:
        field_change = st.text_area(
            "í˜„ì¥ ì²´ê° ë³€í™” (êµ¬ì²´ì ìœ¼ë¡œ)",
            placeholder="ì˜ˆ: ë°°ë‹¬ì•± ìˆ˜ìˆ˜ë£Œ 35%ë¡œ ì˜¤ë¥´ë©´ì„œ ì›” ìˆœìˆ˜ìµ 80ë§Œì›ëŒ€ë¡œ ì¶”ë½...",
            height=120
        )

    st.divider()
    st.header("2) ìºë¦­í„° ì„ íƒ")
    
    char_select = st.selectbox("ìºë¦­í„° ì„ íƒ (10ì¢…)", list(CHARACTERS.keys()))
    
    if char_select:
        char_info = CHARACTERS[char_select]
        col1, col2, col3 = st.columns(3)
        with col1:
            st.markdown(f"""<div class="section-card">
            <b>ğŸ‘¤ ì§ì—…/ë‚˜ì´</b><br>{char_info['ì§ì—…']}<br><br>
            <b>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ê°€ì¡±</b><br>{char_info['ê°€ì¡±']}
            </div>""", unsafe_allow_html=True)
        with col2:
            st.markdown(f"""<div class="section-card">
            <b>ğŸ’­ ìš•ë§</b><br>{char_info['ìš•ë§']}<br><br>
            <b>âš¡ ì••ë°•</b><br>{char_info['ì••ë°•']}
            </div>""", unsafe_allow_html=True)
        with col3:
            st.markdown(f"""<div class="section-card">
            <b>ğŸ¯ íŠ¸ë¦¬ê±°</b><br>{char_info['íŠ¸ë¦¬ê±°']}<br><br>
            <b>ğŸ”„ ë°˜ì „</b><br>{char_info['ë°˜ì „']}
            </div>""", unsafe_allow_html=True)

        st.subheader("ìºë¦­í„° 20% ìˆ˜ì • (ì„ íƒì‚¬í•­)")
        col1, col2 = st.columns(2)
        with col1:
            custom_trigger = st.text_input("íŠ¸ë¦¬ê±° ìˆ˜ì •", value=char_info['íŠ¸ë¦¬ê±°'])
        with col2:
            custom_twist = st.text_input("ë°˜ì „ ìˆ˜ì •", value=char_info['ë°˜ì „'])

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
with tab2:
    st.header("3) ì‚¬ì—° í”Œë¡¯ (3ë§‰)")

    col1, col2 = st.columns(2)
    with col1:
        detail_a = st.text_area("í˜„ì‹¤ ë””í…Œì¼ A", placeholder="ì˜ˆ: ë°°ë‹¬ì•± ìˆ˜ìˆ˜ë£Œ 35% ì¸ìƒ â†’ ì¹´ë“œê°’ ì—°ì²´", height=80)
        detail_b = st.text_area("í˜„ì‹¤ ë””í…Œì¼ B", placeholder="ì˜ˆ: ê³ ë“±í•™ìƒ ì•„ì´ í•™ì›ë¹„ ì›” 80ë§Œì›", height=80)
    with col2:
        detail_c = st.text_area("í˜„ì‹¤ ë””í…Œì¼ C", placeholder="ì˜ˆ: ì„ëŒ€ë£Œ 10% ì¸ìƒ í†µë³´", height=80)
        jp_question = st.text_input(
            "ì¼ë³¸ ì‹œì²­ì ì§ˆë¬¸",
            placeholder="ì˜ˆ: ã‚ãªãŸãªã‚‰ã€ã©ã†ã—ã¾ã—ãŸã‹ï¼Ÿ"
        )

    theme_word = st.text_input("í•µì‹¬ í…Œë§ˆ í•œ ë‹¨ì–´ (í›… ìƒì„±ìš©)", placeholder="ì˜ˆ: íì—… ìœ„ê¸°")

    if st.button("ğŸš€ í”Œë¡¯ + í›… ìƒì„±", use_container_width=True):
        if char_select:
            char_info = CHARACTERS[char_select]
            trigger_use = custom_trigger if 'custom_trigger' in dir() and custom_trigger else char_info['íŠ¸ë¦¬ê±°']

            st.subheader("ğŸ“œ 3ë§‰ í”Œë¡¯")
            plot_text = generate_plot(char_select, theme_word or "í˜„ì‹¤", detail_a, detail_b, detail_c, jp_question)
            st.markdown(f'<div class="output-box">{plot_text}</div>', unsafe_allow_html=True)

            st.subheader("ğŸ¯ ì¼ë³¸ì–´ í›… 5ê°œ")
            hooks = generate_hooks(trigger_use, theme_word or "ì´ í˜„ì‹¤", char_info['ì§ì—…'])
            for i, hook in enumerate(hooks, 1):
                st.markdown(f'<div class="output-box"><b>{i}.</b> {hook}</div>', unsafe_allow_html=True)

            st.session_state['plot_text'] = plot_text
            st.session_state['hooks'] = hooks
            st.session_state['char_select'] = char_select
            st.session_state['summary'] = summary
            st.session_state['theme_word'] = theme_word
        else:
            st.warning("ìºë¦­í„°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.")

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
with tab3:
    st.header("4) ì œì‘ ì‚°ì¶œë¬¼")

    col1, col2 = st.columns(2)
    with col1:
        title_draft = st.text_input("ì œëª© (ê°€ì œ)", placeholder="ì˜ˆ: ë°°ë‹¬ê¸°ì‚¬ ì•„ë²„ì§€ì˜ ë¹„ë°€")
        thumbnail_text = st.text_input("ì¸ë„¤ì¼ ë¬¸êµ¬ (6~10ì)", placeholder="ì˜ˆ: ê²°ì œ ê±°ì ˆ, ê·¸ ë‹¤ìŒ")
    with col2:
        fixed_comment = st.text_input(
            "ê³ ì •ëŒ“ê¸€ ì§ˆë¬¸ 1ê°œ",
            placeholder="ì˜ˆ: ã‚ãªãŸã®å‘¨ã‚Šã«ã‚‚ã€ã“ã‚“ãªæ–¹ã¯ã„ã¾ã™ã‹ï¼Ÿ"
        )
        project_line = st.text_input(
            "New Project í•œ ì¤„",
            placeholder="ì˜ˆ: [EP1] íƒë°°ê¸°ì‚¬ ì•„ë²„ì§€ - ë³´í—˜ í•´ì§€ ë°˜ì „"
        )

    if st.button("ğŸ“‹ ìµœì¢… ê¸°íšì„œ ìƒì„± & ë³µì‚¬ìš© í…ìŠ¤íŠ¸", use_container_width=True):
        now = datetime.now().strftime("%Y-%m-%d %H:%M")
        
        final_doc = f"""
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¬ JP4060 ìœ íŠœë¸Œ ê¸°íšì„œ
ìƒì„±ì¼ì‹œ: {now}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## 1) í•œêµ­ í˜„ì‹¤ ê·¼ê±°
- í•œ ì¤„ ìš”ì•½: {st.session_state.get('summary', summary or 'ë¯¸ì…ë ¥')}
- í•µì‹¬ í…Œë§ˆ: {st.session_state.get('theme_word', theme_word or 'ë¯¸ì…ë ¥')}

## 2) ì„ íƒ ìºë¦­í„°
{st.session_state.get('char_select', char_select or 'ë¯¸ì„ íƒ')}

## 3) í”Œë¡¯
{st.session_state.get('plot_text', '(Tab2ì—ì„œ ìƒì„±í•˜ì„¸ìš”)')}

## 4) ì¼ë³¸ì–´ í›… 5ê°œ
{chr(10).join([f"{i+1}. {h}" for i, h in enumerate(st.session_state.get('hooks', []))]) or '(Tab2ì—ì„œ ìƒì„±í•˜ì„¸ìš”)'}

## 5) ì œì‘ ì‚°ì¶œë¬¼
- ì œëª©(ê°€ì œ): {title_draft or 'ë¯¸ì…ë ¥'}
- ì¸ë„¤ì¼ ë¬¸êµ¬: {thumbnail_text or 'ë¯¸ì…ë ¥'}
- ê³ ì •ëŒ“ê¸€ ì§ˆë¬¸: {fixed_comment or 'ë¯¸ì…ë ¥'}
- New Project í•œ ì¤„: {project_line or 'ë¯¸ì…ë ¥'}

## âœ… ì œì‘ ì²´í¬ë¦¬ìŠ¤íŠ¸
â–¡ (1) ì œëª©(ê°€ì œ) í™•ì • â†’ ë³µì‚¬
â–¡ (2) STUDIO DASHBOARD â†’ New Project(ëŒ€ë³¸) í´ë¦­
â–¡ (3) ìƒì„±ëœ [NEW] ë’¤ì— ì œëª© ë¶™ì´ê¸°
â–¡ (4) í›… 1ë¬¸ì¥ë¶€í„° ì²´í¬
â–¡ (5) GitHub ì»¤ë°‹ â†’ Streamlit ë°°í¬ í™•ì¸

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        """

        st.subheader("ğŸ“„ ìµœì¢… ê¸°íšì„œ")
        st.markdown(f'<div class="output-box">{final_doc}</div>', unsafe_allow_html=True)
        
        st.download_button(
            label="â¬‡ï¸ ê¸°íšì„œ í…ìŠ¤íŠ¸ ë‹¤ìš´ë¡œë“œ",
            data=final_doc,
            file_name=f"jp4060_plan_{datetime.now().strftime('%Y%m%d_%H%M')}.txt",
            mime="text/plain",
            use_container_width=True
        )

    st.divider()
    st.subheader("ğŸ“ GitHub ì—…ë¡œë“œ ì•ˆë‚´")
    st.markdown("""
<div class="section-card">

**1ë‹¨ê³„: GitHub ì €ì¥ì†Œ ì¤€ë¹„**
```
ì €ì¥ì†Œì— í•„ìš”í•œ íŒŒì¼:
â”œâ”€â”€ app.py          (ì´ íŒŒì¼)
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

**2ë‹¨ê³„: requirements.txt ë‚´ìš©**
```
streamlit>=1.28.0
```

**3ë‹¨ê³„: Streamlit Cloud ë°°í¬**
1. streamlit.io/cloud ì ‘ì† â†’ GitHub ì—°ë™
2. `app.py` ì„ íƒ â†’ Deploy í´ë¦­
3. URL ê³µìœ  â†’ ì™„ë£Œ âœ…

**ì—…ë¡œë“œëŠ” ì§ì ‘** (GitHub ì›¹ì—ì„œ íŒŒì¼ ë“œë˜ê·¸&ë“œë¡­ ê°€ëŠ¥)
</div>
""", unsafe_allow_html=True)
